Rails application modeling several associations, functionaliy, testing, devise (for auth) 